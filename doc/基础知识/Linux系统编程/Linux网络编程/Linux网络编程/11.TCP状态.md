# 11.TCP状态  


##  netstat 命令 查看网络状态 (net state)

* 启动服务器进程  
* 打开客户端  

* netstat -apn | grep client  过滤下，查看客户端的状态  

* netstat -apn | grep 端口号  查看某个端口号的网络状态  
    * 可以发现，当服务器与客户端进程都执行以后，双方状态是 ESTABLISHED  服务器还有一个处于LISTEN状态  
    * 在这里主动发起连接方是客户端，状态图中的 SYN_SENT，如果网络畅通，不容易观察到这个状态  

![image](https://user-images.githubusercontent.com/58176267/178522761-18e43322-72a9-4724-ab33-435ee8fe58f0.png)

* **四次挥手**
    * 主动发起方 发送FIN标志位  另一端回复ACK  此时主动方进入**半关闭状态**     
    * 对于下图，FIN_WAIT2相当于就是半关闭状态  
    * 主动方接收到另一端的FIN，并且成功发送ACK后，进入TIME_WAIT状态  
    * 主动方在TIME_WAIT状态时，并没有真正关闭，还需要等待2MSL，主要是防止自己的ACK没有被另一端收到，导致重发FIN，如果等待这段时间又收到FIN，可以重发ACK  
        * 2MSL大约40s？ 过了这个时间，就可以确认被动方收到了自己的ACK  

![image](https://user-images.githubusercontent.com/58176267/178525285-ba7463cc-4cd5-49f0-8f5e-b894ae443cbc.png)  


![image](https://user-images.githubusercontent.com/58176267/178525635-a5a9565d-4f4c-465d-82fc-8761ea463c2c.png)  



