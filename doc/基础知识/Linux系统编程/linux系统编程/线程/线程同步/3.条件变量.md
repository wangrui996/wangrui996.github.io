# 3.条件变量  

* 实现线程同步的一种手段  
* 本身不是锁  但是通常要结合互斥锁来使用  

![image](https://user-images.githubusercontent.com/58176267/174086039-a24b134c-db59-44a1-8ba6-7c0d3b48164d.png)  


## 条件变量初始化    

* pthread_cond_t cond = PTHREAD_COND_INITIALIZER  表示静态初始化,使用操作系统提供的宏  
* 使用init函数相当于动态初始化,用到的时候再初始化  
* 与mutex那里类似  

![image](https://user-images.githubusercontent.com/58176267/174202388-7d01b9fc-5733-4dc7-8713-1d743b489aa8.png)  



## pthread_cond_wait 函数 

* 作用：阻塞等待某一条件满足  
* 从wait函数看出,要使用必须先创建一把互斥锁  

![image](https://user-images.githubusercontent.com/58176267/174203049-d3ffe4d8-ea12-4d75-b6b0-ff94ed06b94e.png)  


* pthread_cond_wait相当于完成方框中的任务, 在使用之前一定是先创建了一把锁   在使用该函数后,等待条件满足时解锁,自己这个线程进入阻塞状态(**阻塞、解锁合起来是一个原子操作**) ; 等条件满足时 解除阻塞并重新加锁     条件满足的依据是  pthread_cond_signal() 或 pthread_cond_broadcast()

* pthread_cond_timewait 有一个超时设置,超过这个时间还没满足条件就不再阻塞  

![image](https://user-images.githubusercontent.com/58176267/174204340-03e69183-ff7b-4325-970a-43b74b593e06.png)


## 条件变量的生产者消费者模型  

![image](https://user-images.githubusercontent.com/58176267/174205520-67896f7d-a7df-4423-ae0a-9d754ddf2186.png)

### 条件变量实现生产者消费者代码  

![image](https://user-images.githubusercontent.com/58176267/174205621-f479a8c0-e394-4dcc-8ab3-a86121ea5d99.png)   
![image](https://user-images.githubusercontent.com/58176267/174205778-7bbe6e32-a569-429f-ad8e-304b0de472f7.png)  
![image](https://user-images.githubusercontent.com/58176267/174205799-4b812eb5-d5da-4082-889a-9a9e31e580c4.png)  
![image](https://user-images.githubusercontent.com/58176267/174205832-33a56b1e-0208-4bf0-b534-9de9f7e3a853.png)  















 
