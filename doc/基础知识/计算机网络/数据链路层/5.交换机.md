# 5.交换机  

* 链路层设备  
* 主要指针对以太网的交换机  
* **作用：存储-转发以太网帧**  

![image](https://user-images.githubusercontent.com/58176267/179131161-a75fbe76-7f4d-464d-a490-4f115df7712c.png)  


* 交换机再每段链路上利用CSMA/CD收发帧，无冲突(**原因是每一个接口只连接一个计算机，一个接口所连接的网络只有一个冲突域**)  

![image](https://user-images.githubusercontent.com/58176267/179131403-63ba843f-398a-457e-8bc7-29e172368102.png)  


## 交换表  

* 问题中，A' 和 B’ 应该是MAC地址，也就是交换机收到一个数据帧，知道它的目的MAC地址，是怎样知道它对应的是那个接口？  
* **每个交换机维护一个交换表，每一个交换表项(入口)，记录了主机的MAC地址，和到达主机的接口，时间戳** 时间戳超时以后，该交换表项清除，再重新学习    

![image](https://user-images.githubusercontent.com/58176267/179132021-de792b60-cfa4-4fcf-ae76-10a0b62e0e64.png)  


## 交换机：自学习  

![image](https://user-images.githubusercontent.com/58176267/179132462-11d00b08-b822-4f51-9fdf-0ffadcc2b540.png)  


## 交换机 帧过滤/转发  

* 检索目的MAC地址发现在交换表中有，还要做一层判断，就是判断这个目的MAC地址(目的主机)位于的网段，是否和收到这个帧接口所处于的网段相同  如果相同说明发送这个帧的主机和接收这个帧的主机处于同一个网段，对于对于交换机来说，就是出于同一个接口上，此时在交换机看来就没必要转发，丢弃帧    
* 如果在交换表没有检索到与目的MAC地址匹配的表项，进行**泛洪(flood)**:向除收到该帧的接口之外的所有接口转发  


## 自学习和转发过程 举例  

![image](https://user-images.githubusercontent.com/58176267/179133975-bef181b8-e5a2-4454-a5f2-3e1110bfbf0a.png)  


## 交换机互连  

* 自学习过程，假如A向G发送帧时(假设一开始四个交换机的交换表都是空的)，当S1收到了A要发送给G的数据帧以后，它不知道往那个接口转发，因此泛洪，S4就会收到该数据帧，然后它也不知道该数据帧中的MAC地址对应哪个接口，因此，它也泛洪，S3也会收到该数据帧，然后S3不知道该数据帧交给哪个接口，又进行泛洪，该数据帧就会被发送给G   **注意在这个过程中，S1,S1,S3等，都会学习到A(MAC地址)对应哪个网段**  


## 组织机构网络  

![image](https://user-images.githubusercontent.com/58176267/179137077-702871aa-d770-40d1-904e-4eeb6036b3e9.png)

* 如果右边的网络不再包含路由器，对应的就是一个IP子网  
* 在这个IP子网中，任何一个交换机收到了在这个网络范围内的任何一个主机(也包括这个路由器连接该网络的接口)，如果收到的是一个广播帧，(目的MAC地址全1)，所有交换机都会把这个广播帧转发到所有其他接口上  因此这样一个IP子网也称为一个广播域  
    * 比如ARP的广播

![image](https://user-images.githubusercontent.com/58176267/179137820-2717e350-97cc-466a-ab68-0f58eb97be64.png)



## 交换机 VS 路由器  


![image](https://user-images.githubusercontent.com/58176267/179139749-299c17a9-06cd-4c9a-968e-300c54323fac.png)  


* 直通传输 ： 作为交换机，可以在一个接口上接收数据帧的同时，直接就把它转发到另一个接口上，也就是边收边发  
* 交换机可以隔离冲突域，但是不能隔离广播域  

![image](https://user-images.githubusercontent.com/58176267/179141042-94977327-2035-40f1-9713-9d7b40fc70a0.png)






















