# Email消息格式与POP3协议  


## SMTP协议  

### 文本消息格式标准  RFC822  

* 头部行(header)  
    * To
    * From
    * Subject
与SMTP命令不同  

* 消息体(body)    
    * 消息本身  
    * 只能是ASCII码  

### MIME：多媒体邮件扩展  RFC2045,2056  

* 通过在邮件头部增加额外的行以声明MIME的内容类型  

![image](https://user-images.githubusercontent.com/58176267/156285864-59c5ce1c-9929-4cee-83fa-b588ff806a85.png)


## 邮件访问协议  

**用户向邮件服务器传输，邮件服务器之间传输邮件采用SMTP协议，用户从邮件服务器获取邮件采用的是邮件访问协议**

**邮件访问协议：用户从服务器获取邮件  

![image](https://user-images.githubusercontent.com/58176267/156286120-7519eadc-006e-42c9-8028-4fbaa3ba2919.png)

### POP协议 Post Office Protocol  

* **认证/授权(客户端<-->服务器)**  和  **下载**

使用ACSII码方式  

#### 认证过程  

* 客户端命令
   * User：用户名
   * Pass：声明密码  
* 服务器响应  
   * +OK
   * -ERR

#### 事物阶段  

* List：列出消息数量  
* Retr：用编号获取消息  
* Dele：删除消息  
* Quit 退出  

#### “下载并删除”模式  

* 一般是客户端从邮件服务器将邮件下载到本地然后删除邮件服务器中对应的内容 ，可能会带来一个问题，用户如果换一个客户端软件，无法重读该邮件  

#### “下载并保持”模式  不同客户端都可以保留消息的拷贝  

* 大量Email邮件都会保存在Email邮箱，早期每个用户邮箱的容量有限，不能无限制保存所有邮件  

#### POP3协议是无状态的  

### IMAP Internet Mail Access Protocol  
* 更多功能  
* 更加复杂  
* 能够操纵服务器上存储的消息  

#### 优点  

* 所有消息统一保存在一个地方：服务器    
* 允许用户利用文件夹组织消息  
* IMAP支持跨会话(Session)的用户状态
   * 文件夹的名字 
   * 文件夹与消息ID之间的映射等  
* 有状态的协议  

### HTTP  163，QQ Mail等    

直接使用浏览器收发邮件，不用邮件客户端的话就是采用HTTP协议  
  

