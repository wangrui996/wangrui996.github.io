

# 7.IP子网与子网划分  

* 有类地址划分，不太灵活，如一个企业分配了一个B类网络，可以分配65535台主机(不考虑无法使用的IP)，但企业可能只需要2000个IP地址，就造成了很多浪费  
* 有类地址划分，可能出现下面的情况  
    * 左侧是一个A类网络，它可区分的主机数量是很大的
    * 这样是不利用管理的，如一个IP分组，目的主机是一个A类地址，它要发送到A类地址子网，然后在一个含主机数非常多的子网内寻找那个目的主机  
    
![image](https://user-images.githubusercontent.com/58176267/162652210-07477ec0-7da8-419f-bf56-ff9687703d10.png)


## 子网划分  

* IP地址进一步做文章  

* **子网号/ID：从网络号的高位开始顺序借用若干位**  
    * 如想划分成4个等长的小的子网，就借用网络号中两位 
    * 子网号分别为 00 01 10 11 
    * **通过路由器将这四个小的子网互联，这些子网的信息就反映到路由器的转发表中，当路由器收到到达某一个子网的IP数据报时，就转发到相应子网，其他子网不会受到这次通信的影响**  
    * 将通信的流量进行有效的隔离，这就是进行子网划分的目的  
    * 
* 现在的问题是，怎么知道一个IP地址有没有划分子网，用了多少比特划分子网？

![image](https://user-images.githubusercontent.com/58176267/162653076-7053642b-a841-4bd0-902e-37a9d273db1d.png)

## 子网掩码  

* 通常写成点分十进制的形式  
* 取值  
    * **网络号NetID和子网号SubID位全取1**
    * **主机号HostID位全取0** 
* 例如 ：
    * A类网络，如果没有进行子网划分，子网掩码是255.0.0.0
    * B类网络，没有子网划分，默认的子网掩码是 255.255.0.0
    * C类网络，默认的子网掩码是 255.255.255.0
    * 借用3bit划分子网的B类网络的子网掩码为  255.255.224.0  (即底单个8位组的前三位是1(11100000即224)      后5位和第四个8位组表示主机ID)  

* **子网地址 + 子网掩码 确定一个子网大小(范围)**
    * Internet网络中，明确说出一个IP子网的大小(范围)，单纯的给出子网地址是不够的，还需要子网掩码   

![image](https://user-images.githubusercontent.com/58176267/162653709-68925d7d-8c8f-4667-ab24-55d1f508d10c.png)


### 子网划分例子  

* 下面例子中，划分成四个等长的子网，201.2.3.0 （就是最后8位的前两位为0）    201.2.3.64就是最后8位的前两位为01   也就是201.2.3.0——201.2.3.64之间是一个子网  其他类似 
* 如果只是给出一个 201.2.3.60  只知道它是一个C类IP地址，不知道它是否进行了子网划分   但是通过IP掩码 255.255.255.192 （192即11000000），最后一个8位组不是0而是192，就说明进行了子网划分，并且可以明确知道，是用了两个bit进行划分，那么也可以明确知道201.2.3.60属于划分的等长子网中第一个子网  

* 路由器可以将这四个子网互联，并且通过子网掩码知道一个IP地址是否进行了子网划分，用了多少位进行子网划分，路由器怎样确定一个IP分组转发到哪个子网？
    * 也就是，路由器的转发表，除了存储子网地址外，还必须有相应的子网掩码   

![image](https://user-images.githubusercontent.com/58176267/162654381-c3eb95c1-bff2-48e3-baa7-225898454bbf.png)


### 子网掩码的应用————路由器转发IP分组  


* 下面例子中，用了原主机号中的7位作为网络号，这个IP地址所在的子网的**地址范围是 72.32.0.0~172.32.1.255**  当然，这里面并不是所有地址都可以分配给主机
* **可分配地址范围**： 172.32.0.1~172.32.1.254   (每个子网中，都要去掉主机域全0的和主机域全1的地址)    
    * 该范围内的IP地址，都可以分配给主机或路由器的接口 
    * 即一个子网可分配IP地址数 2^9 - 2 = 510  
* 广播地址:172.32.1.255 (主机号全1）

![image](https://user-images.githubusercontent.com/58176267/162655645-64055872-35e3-4229-843f-12fef35ae3e3.png)


* 下面的例子是将一个C类网络划分成8个子网  
* 其中带颜色的IP地址有特殊含义
    * 红色的代表的是每一个IP子网的子网地址 
    * 绿色的表示每一个IP子网的广播地址
    * 即如果没有子网划分，C类地址中最后一个是.0和.255的地址是不能用的，有子网划分以后，中间还会有一些IP地址不能分配给主机或路由器(也造成了一定的IP地址的损失，但网络性能会得到改进—）

![image](https://user-images.githubusercontent.com/58176267/162655806-285247b6-5d2a-4f3b-b9c7-db0fddaa501a.png)
















