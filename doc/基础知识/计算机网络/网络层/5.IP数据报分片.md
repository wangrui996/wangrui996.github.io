


# 5.IP数据报分片  

![image](https://user-images.githubusercontent.com/58176267/162470730-7ce1f56c-0f4f-44bf-9b54-b45bf81e5a46.png)

## 最大传输单元/MTU  

* **网路链路存在MTU————链路层数据帧可封装的数据的上限**  如以太网是1500字节？

* 假如一个数据报，在一个较大的MTU的链路上传输时，可以封装到一个数据帧中传输，但是可能经过一个路由器，转发到下一MTU较小的链路时，一个数据帧可能就装不下  

![image](https://user-images.githubusercontent.com/58176267/162471734-5102cb30-6864-4424-98dc-4c73c01fa4bd.png)

## IP分片与重组  

* 注意，这里的**可以**，要看标志位是否允许  如果不允许，路由器就会扔掉该分组，并向源主机发送一个ICMP报文  

* **路由器只分不装**   路由器将IP分组分片后，这些分片只有到达目的主机后才进行“重组”  如果某个路由器提前重组了，后面还可能需要MTU较小的链路还要分片，浪费资源  
* IP首部的相关子段用于标识分片以及确定分片的相对顺序
    * 因为，需要明确一个分组是分片了还是没分片，分片了的话，是哪一个片，片与片的相互顺序关系，否则目的主机无法“重组”
    * 如果某个分片丢失了，目的主机会等待一段时间，如果还没收全，会丢掉所有相关分片  


![image](https://user-images.githubusercontent.com/58176267/162473069-3d4899d2-11e6-422d-a7c1-6ae5ed894890.png)
