

# 流水线机制与滑动窗口协议  

**rdt3.0能处理分组错误和丢失的情况，但是效率太低，本质原因是“停——等”操作**  

思路：打破停等协议，在等待的时候能够发送分组  


## 流水线协议  

* 允许发送方在收到ACK之前连续发送多个分组
    * 更大的**序列号范围** 
    * 发送方/接收方需要更大的存储空间以**缓存分组**  原来发送方只用一个分组的存储空间，发送出去以后先存着，如果确认收到了就从缓存中删除，现在没有确认的分组不止一个，因此需要更大的缓存空间  

如下图右边，流水线机制中，链路中同时存在多个分组和ACK  

![image](https://user-images.githubusercontent.com/58176267/160111025-ffda3163-1c65-4e11-8827-43da968d44d5.png)


## 滑动窗口协议  Sliding-window protocol  

* 窗口
    * 允许使用的序列号范围
    * 窗口尺寸为N： 最多有N个等待确认的消息

* 滑动窗口
    * 随着协议的**运行**，窗口在序列号空间内**向前滑动**  如序列号空间范围0-100，滑动窗口使用完了5-10，接下来向后滑动，使用11-15  

* 滑动窗口协议 ： GBN, SR  


如下图，滑动窗口大小为N   
* 窗口左边绿色部分表示已经发送完成并且成功确认的分组  
* 窗口中：黄色部分表示已经发送但还没有确认  如果某一时刻收到了黄色部分最左边这个的确认消息，则窗口就可以向后移动     蓝色部分表示还可以使用的序列号范围
* 

![image](https://user-images.githubusercontent.com/58176267/160111633-ed4535a8-128d-4d6d-8ad8-de138a5ed97d.png)

















