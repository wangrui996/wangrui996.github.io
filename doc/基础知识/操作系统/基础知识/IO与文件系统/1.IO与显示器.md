

# 1.IO与显示器  

![image](https://user-images.githubusercontent.com/58176267/162975378-53bfcb02-cc30-4945-897b-752b67791d9e.png)


* 外设的工作实际上都是 向外设对应的设备控制器(显卡，网卡，磁盘控制器)中的寄存器或存储等写内容   设备控制器由寄存器中内容，实际驱动外设工作  

* CPU发出指令后，外设对应的控制器工作，CPU转而去处理其他进程，当外设工作完成后，向CPU发出中断

* 因此**使用外设的核心是： 向外设的控制器发送指令(查对应的手册)(类似 out xx, al 的指令), 外设工作完成会向CPU发送中断, CPU完成对应的中断处理程序**

![image](https://user-images.githubusercontent.com/58176267/162977692-a5d0b169-938f-401c-85cd-d6af811ac10d.png)

* 不同的外设，它的控制器不同，同一中外设不同公司，不同型号的设备也不同，因此，每种外设都要查寄存器地址，格式，语义等，如果让上层用户直接操作，非常麻烦; 因此，操作系统需要给上层提供一个简单视图————**文件视图**  
    * 比如，无论用什么显示器，向显示器上面打印都是prinf （当然c语言中的prinf不是系统调用）

![image](https://user-images.githubusercontent.com/58176267/162978136-0ea1270d-aaa9-4b8b-afa6-709c7e581fd3.png)


## 设备驱动的一般步骤   

* 1.形成文件视图
* 2.向设备控制器的寄存器发送指令  往往是 out xxx
* 3.进行设备中断的中断处理  


## 一段操纵外设的程序  

![image](https://user-images.githubusercontent.com/58176267/162981183-e03f704a-0a99-4160-9850-6051e2fd6d94.png)


![image](https://user-images.githubusercontent.com/58176267/162981704-25c05471-a529-4529-ab37-4786adc1ccbb.png)








