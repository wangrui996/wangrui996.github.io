

# 多级页表和快表  


## 分页机制引发的问题

* 为了提高内存的空间利用率，页应该尽可能小，但是同一个段分成若干页，页越小意味着页表就大了  

* 程序中的逻辑地址，除以页的大小，得到一个页号(页表项)，之后查找页表得到页框号以后，乘以4K得到物理地址;
* 也就是说，32位机器中，用户写的程序逻辑地址空间很大，但页很小，得到的逻辑页号会很多，每个逻辑页号要建立对应的物理页框的关系，页表就会很大
* 32位机器中，程序中的逻辑地址可以有2^32,  4G / 4K = 1M (2^32 / 2^12 = 2 ^ 20) 会有1M大小的页表项，一个页表项一般是4个字节，所以一个进程就需要4M的内存保存页表；
* 实际上，一个进程并不是真的就要用4G这么多逻辑地址  大部分逻辑地址根本用不到

![image](https://user-images.githubusercontent.com/58176267/161534958-6efb178a-80c1-4294-b6f4-38b34e365792.png)

* 如下图，一个进程如果按4G内存，可能需要1M个的页表项，但实际中，不可能每个页表项对应的物理地址都被使用，如下图，页号为2的页表项就没用(代码段分别放到了页框号1,5,6的地方，三个页表项就行)  


![image](https://user-images.githubusercontent.com/58176267/161537090-6f938ea1-a1e0-4627-b4e2-5ca10e027530.png)

![image](https://user-images.githubusercontent.com/58176267/161537411-6a28c201-0a7a-42f2-9bb4-32228228960b.png)
